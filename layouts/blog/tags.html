{{ define "main" }}
<div class="container">
    <header class="page-header">
        <h1>Tags</h1>
        <p class="page-description">All tags used on this blog</p>
    </header>
    
    {{ $blogPages := where .Site.RegularPages "Section" "blog" }}
    {{ $tags := slice }}
    {{ range $blogPages }}
        {{ range .Params.tags }}
            {{ $tags = $tags | append . }}
        {{ end }}
    {{ end }}
    
    {{ $uniqueTags := $tags | uniq }}
    {{ if $uniqueTags }}
    <div class="terms-list">
        {{ range $uniqueTags }}
        {{ $tag := . }}
        {{ $tagPosts := where $blogPages ".Params.tags" "intersect" (slice $tag) }}
        <div class="term-item">
            <h3 class="term-name">
                <a href="{{ printf "/blog/tags/%s/" (. | urlize) | relURL }}">{{ . }}</a>
            </h3>
            <p class="term-count">{{ len $tagPosts }} {{ if eq (len $tagPosts) 1 }}post{{ else }}posts{{ end }}</p>
        </div>
        {{ end }}
    </div>
    {{ else }}
    <p class="no-terms">No tags found.</p>
    {{ end }}
</div>
{{ end }}
